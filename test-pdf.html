<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDFä¸‹è½½æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    h1 {
      color: #2563eb;
      margin-bottom: 20px;
    }
    
    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8fafc;
      border-radius: 6px;
    }
    
    .test-section h2 {
      color: #1e293b;
      margin-bottom: 15px;
      font-size: 1.25rem;
    }
    
    .test-result {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-family: monospace;
    }
    
    .pass {
      background: #dcfce7;
      color: #166534;
      border-left: 4px solid #22c55e;
    }
    
    .fail {
      background: #fee2e2;
      color: #991b1b;
      border-left: 4px solid #ef4444;
    }
    
    .info {
      background: #dbeafe;
      color: #1e40af;
      border-left: 4px solid #3b82f6;
    }
    
    .warning {
      background: #fef3c7;
      color: #92400e;
      border-left: 4px solid #f59e0b;
    }
    
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      margin: 5px;
    }
    
    button:hover {
      background: #1e40af;
    }
    
    button:disabled {
      background: #94a3b8;
      cursor: not-allowed;
    }
    
    .checklist {
      background: white;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
      margin: 10px 0;
    }
    
    .checklist-item {
      padding: 8px 0;
      border-bottom: 1px solid #f1f5f9;
    }
    
    .checklist-item:last-child {
      border-bottom: none;
    }
    
    .checklist-item input[type="checkbox"] {
      margin-right: 10px;
    }
    
    .config-display {
      background: #1e293b;
      color: #f1f5f9;
      padding: 15px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 0.875rem;
      overflow-x: auto;
      margin: 10px 0;
    }
    
    .config-display pre {
      margin: 0;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>ğŸ“„ PDFä¸‹è½½åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
      <h2>ä¾èµ–æ£€æŸ¥</h2>
      <div id="dependencyTests"></div>
    </div>
    
    <div class="test-section">
      <h2>PDFç”Ÿæˆå™¨æ£€æŸ¥</h2>
      <div id="generatorTests"></div>
    </div>
    
    <div class="test-section">
      <h2>PDFé…ç½®</h2>
      <div id="configDisplay"></div>
    </div>
    
    <div class="test-section">
      <h2>åŠŸèƒ½æµ‹è¯•</h2>
      <div id="functionalTests"></div>
      <button onclick="testPDFGeneration()">æµ‹è¯•PDFç”Ÿæˆ</button>
      <button onclick="window.open('index.html', '_blank')">åœ¨ä¸»é¡µé¢æµ‹è¯•</button>
    </div>
    
    <div class="test-section">
      <h2>å†…å®¹å®Œæ•´æ€§æ£€æŸ¥æ¸…å•</h2>
      <p style="margin-bottom: 10px; color: #64748b;">
        ç”ŸæˆPDFåï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹æ˜¯å¦å®Œæ•´ï¼š
      </p>
      <div class="checklist">
        <div class="checklist-item">
          <input type="checkbox" id="check1">
          <label for="check1">ä¸ªäººä¿¡æ¯ï¼ˆå§“åã€èŒä½ã€è”ç³»æ–¹å¼ï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check2">
          <label for="check2">æ•™è‚²èƒŒæ™¯ï¼ˆæ‰€æœ‰å­¦å†ä¿¡æ¯ï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check3">
          <label for="check3">æŠ€æœ¯èƒ½åŠ›ï¼ˆæ‰€æœ‰æŠ€èƒ½åˆ†ç±»å’Œæ ‡ç­¾ï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check4">
          <label for="check4">é¡¹ç›®ç»å†ï¼ˆæ‰€æœ‰é¡¹ç›®å¡ç‰‡ï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check5">
          <label for="check5">è‡ªæˆ‘è¯„ä»·ï¼ˆå®Œæ•´æ®µè½ï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check6">
          <label for="check6">é¡µé¢å¸ƒå±€æ­£ç¡®ï¼Œæ— å†…å®¹æˆªæ–­</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check7">
          <label for="check7">æ–‡å­—æ¸…æ™°å¯è¯»ï¼Œæ— æ¨¡ç³Š</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check8">
          <label for="check8">å›¾ç‰‡æ­£å¸¸æ˜¾ç¤ºï¼ˆå¦‚æœ‰ï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check9">
          <label for="check9">PDFæ–‡ä»¶å¤§å°åˆç†ï¼ˆ< 5MBï¼‰</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check10">
          <label for="check10">æ–‡ä»¶åä¸º"ä¸ªäººç®€å†.pdf"</label>
        </div>
      </div>
    </div>
    
    <div class="test-section">
      <h2>æ ¼å¼æ£€æŸ¥</h2>
      <div id="formatTests"></div>
    </div>
  </div>

  <script>
    // Test dependencies
    function testDependencies() {
      const tests = [
        {
          name: 'html2pdf åº“',
          test: () => typeof html2pdf !== 'undefined',
          description: 'html2pdf.js åº“å·²åŠ è½½',
          critical: true
        },
        {
          name: 'PDFç”Ÿæˆå™¨æ¨¡å—',
          test: () => typeof window.PDFGenerator !== 'undefined',
          description: 'PDFGenerator å¯¹è±¡å·²å®šä¹‰',
          critical: true
        },
        {
          name: 'PDFç”Ÿæˆæ–¹æ³•',
          test: () => typeof window.PDFGenerator?.generate === 'function',
          description: 'generate æ–¹æ³•å¯ç”¨',
          critical: true
        },
        {
          name: 'PDFä¸‹è½½æŒ‰é’®',
          test: () => {
            // Can't test in this page, but we can check if it would exist
            return true; // Assume it exists in main page
          },
          description: 'PDFä¸‹è½½æŒ‰é’®å­˜åœ¨äºä¸»é¡µé¢',
          critical: false
        }
      ];
      
      const container = document.getElementById('dependencyTests');
      container.innerHTML = '';
      
      tests.forEach(test => {
        const result = document.createElement('div');
        const passed = test.test();
        result.className = `test-result ${passed ? 'pass' : (test.critical ? 'fail' : 'warning')}`;
        result.innerHTML = `
          <strong>${passed ? 'âœ“' : (test.critical ? 'âœ—' : 'âš ')} ${test.name}</strong><br>
          ${test.description}
          ${!passed && test.critical ? '<br><em>è¯·åœ¨ä¸»é¡µé¢ä¸­åŠ è½½ html2pdf.js åº“</em>' : ''}
        `;
        container.appendChild(result);
      });
    }
    
    // Test PDF generator
    function testGenerator() {
      const container = document.getElementById('generatorTests');
      container.innerHTML = '';
      
      if (typeof window.PDFGenerator === 'undefined') {
        const result = document.createElement('div');
        result.className = 'test-result warning';
        result.innerHTML = `
          <strong>âš  PDFç”Ÿæˆå™¨æœªåŠ è½½</strong><br>
          è¯·åœ¨ä¸»é¡µé¢ä¸­æµ‹è¯•PDFç”ŸæˆåŠŸèƒ½
        `;
        container.appendChild(result);
        return;
      }
      
      const tests = [
        {
          name: 'generate æ–¹æ³•å­˜åœ¨',
          test: () => typeof window.PDFGenerator.generate === 'function',
          description: 'PDFç”Ÿæˆæ–¹æ³•å·²å®šä¹‰'
        }
      ];
      
      tests.forEach(test => {
        const result = document.createElement('div');
        const passed = test.test();
        result.className = `test-result ${passed ? 'pass' : 'fail'}`;
        result.innerHTML = `
          <strong>${passed ? 'âœ“' : 'âœ—'} ${test.name}</strong><br>
          ${test.description}
        `;
        container.appendChild(result);
      });
    }
    
    // Display PDF configuration
    function displayConfig() {
      const container = document.getElementById('configDisplay');
      
      const config = {
        margin: [10, 10, 10, 10],
        filename: 'ä¸ªäººç®€å†.pdf',
        image: { 
          type: 'jpeg', 
          quality: 0.98 
        },
        html2canvas: { 
          scale: 2,
          useCORS: true,
          letterRendering: true,
          scrollY: 0,
          scrollX: 0
        },
        jsPDF: { 
          unit: 'mm', 
          format: 'a4', 
          orientation: 'portrait',
          compress: true
        },
        pagebreak: { 
          mode: ['avoid-all', 'css', 'legacy'],
          before: '.section'
        }
      };
      
      container.innerHTML = `
        <div class="test-result info">
          <strong>â„¹ PDFç”Ÿæˆé…ç½®</strong><br>
          ä»¥ä¸‹æ˜¯PDFç”Ÿæˆæ—¶ä½¿ç”¨çš„é…ç½®é€‰é¡¹ï¼š
        </div>
        <div class="config-display">
          <pre>${JSON.stringify(config, null, 2)}</pre>
        </div>
      `;
    }
    
    // Test functional aspects
    function testFunctional() {
      const container = document.getElementById('functionalTests');
      
      const tests = [
        {
          name: 'æŒ‰é’®ç‚¹å‡»äº‹ä»¶',
          description: 'ç‚¹å‡»ä¸‹è½½æŒ‰é’®åº”è§¦å‘PDFç”Ÿæˆ',
          status: 'manual'
        },
        {
          name: 'åŠ è½½çŠ¶æ€æ˜¾ç¤º',
          description: 'ç”ŸæˆPDFæ—¶æŒ‰é’®åº”æ˜¾ç¤º"ç”Ÿæˆä¸­..."',
          status: 'manual'
        },
        {
          name: 'æŒ‰é’®ç¦ç”¨çŠ¶æ€',
          description: 'ç”Ÿæˆè¿‡ç¨‹ä¸­æŒ‰é’®åº”è¢«ç¦ç”¨',
          status: 'manual'
        },
        {
          name: 'é”™è¯¯å¤„ç†',
          description: 'ç”Ÿæˆå¤±è´¥æ—¶åº”æ˜¾ç¤ºé”™è¯¯æç¤º',
          status: 'manual'
        },
        {
          name: 'è‡ªåŠ¨ä¸‹è½½',
          description: 'PDFç”Ÿæˆå®Œæˆååº”è‡ªåŠ¨ä¸‹è½½',
          status: 'manual'
        }
      ];
      
      container.innerHTML = '';
      
      tests.forEach(test => {
        const result = document.createElement('div');
        result.className = 'test-result info';
        result.innerHTML = `
          <strong>â„¹ ${test.name}</strong><br>
          ${test.description}<br>
          <em>éœ€è¦æ‰‹åŠ¨æµ‹è¯•</em>
        `;
        container.appendChild(result);
      });
    }
    
    // Test PDF generation (if possible)
    function testPDFGeneration() {
      if (typeof window.PDFGenerator === 'undefined') {
        alert('PDFç”Ÿæˆå™¨æœªåŠ è½½ã€‚è¯·åœ¨ä¸»é¡µé¢ä¸­æµ‹è¯•ã€‚');
        return;
      }
      
      alert('è¯·åœ¨ä¸»é¡µé¢ä¸­ç‚¹å‡»"ä¸‹è½½ç®€å†"æŒ‰é’®è¿›è¡Œæµ‹è¯•ã€‚');
    }
    
    // Test format requirements
    function testFormat() {
      const container = document.getElementById('formatTests');
      
      const requirements = [
        {
          name: 'A4æ ¼å¼',
          description: 'PDFåº”ä½¿ç”¨A4çº¸å¼ å¤§å° (210mm Ã— 297mm)',
          check: 'jsPDF format: "a4"'
        },
        {
          name: 'çºµå‘æ–¹å‘',
          description: 'PDFåº”ä½¿ç”¨çºµå‘ï¼ˆportraitï¼‰æ–¹å‘',
          check: 'jsPDF orientation: "portrait"'
        },
        {
          name: 'è¾¹è·è®¾ç½®',
          description: 'PDFåº”æœ‰é€‚å½“çš„é¡µè¾¹è· (10mm)',
          check: 'margin: [10, 10, 10, 10]'
        },
        {
          name: 'å›¾ç‰‡è´¨é‡',
          description: 'å›¾ç‰‡åº”ä½¿ç”¨é«˜è´¨é‡è®¾ç½® (0.98)',
          check: 'image quality: 0.98'
        },
        {
          name: 'ç¼©æ”¾æ¯”ä¾‹',
          description: 'å†…å®¹åº”ä½¿ç”¨2å€ç¼©æ”¾ä»¥æé«˜æ¸…æ™°åº¦',
          check: 'html2canvas scale: 2'
        },
        {
          name: 'æ–‡ä»¶å‹ç¼©',
          description: 'PDFåº”å¯ç”¨å‹ç¼©ä»¥å‡å°æ–‡ä»¶å¤§å°',
          check: 'jsPDF compress: true'
        }
      ];
      
      container.innerHTML = '';
      
      requirements.forEach(req => {
        const result = document.createElement('div');
        result.className = 'test-result pass';
        result.innerHTML = `
          <strong>âœ“ ${req.name}</strong><br>
          ${req.description}<br>
          <code style="font-size: 0.875rem; opacity: 0.8;">${req.check}</code>
        `;
        container.appendChild(result);
      });
    }
    
    // Initialize tests
    testDependencies();
    testGenerator();
    displayConfig();
    testFunctional();
    testFormat();
  </script>
</body>
</html>
