<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸»é¢˜åˆ‡æ¢æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    h1 {
      color: #2563eb;
      margin-bottom: 20px;
    }
    
    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8fafc;
      border-radius: 6px;
    }
    
    .test-section h2 {
      color: #1e293b;
      margin-bottom: 15px;
      font-size: 1.25rem;
    }
    
    .test-result {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-family: monospace;
    }
    
    .pass {
      background: #dcfce7;
      color: #166534;
      border-left: 4px solid #22c55e;
    }
    
    .fail {
      background: #fee2e2;
      color: #991b1b;
      border-left: 4px solid #ef4444;
    }
    
    .info {
      background: #dbeafe;
      color: #1e40af;
      border-left: 4px solid #3b82f6;
    }
    
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      margin: 5px;
    }
    
    button:hover {
      background: #1e40af;
    }
    
    .theme-preview {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 15px;
    }
    
    .theme-card {
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .theme-card-header {
      padding: 15px;
      font-weight: 600;
      text-align: center;
    }
    
    .theme-card-body {
      padding: 20px;
      min-height: 200px;
    }
    
    .light-theme {
      background: #ffffff;
      color: #1e293b;
    }
    
    .light-theme .theme-card-header {
      background: #f8fafc;
      color: #1e293b;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .dark-theme {
      background: #0f172a;
      color: #f1f5f9;
    }
    
    .dark-theme .theme-card-header {
      background: #1e293b;
      color: #f1f5f9;
      border-bottom: 1px solid #334155;
    }
    
    .color-swatch {
      display: inline-block;
      width: 40px;
      height: 40px;
      border-radius: 4px;
      margin: 5px;
      border: 2px solid #e2e8f0;
    }
    
    .storage-info {
      background: white;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
      margin: 10px 0;
    }
    
    .storage-info code {
      background: #f1f5f9;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>ğŸŒ“ ä¸»é¢˜åˆ‡æ¢æµ‹è¯•</h1>
    
    <div class="test-section">
      <h2>ä¸»é¢˜åŠŸèƒ½æµ‹è¯•</h2>
      <div id="themeFunctionTests"></div>
      <button onclick="testThemeToggle()">æµ‹è¯•ä¸»é¢˜åˆ‡æ¢</button>
      <button onclick="testLocalStorage()">æµ‹è¯•æœ¬åœ°å­˜å‚¨</button>
      <button onclick="clearThemePreference()">æ¸…é™¤ä¸»é¢˜åå¥½</button>
    </div>
    
    <div class="test-section">
      <h2>ä¸»é¢˜é¢„è§ˆ</h2>
      <div class="theme-preview">
        <div class="theme-card light-theme">
          <div class="theme-card-header">æµ…è‰²ä¸»é¢˜</div>
          <div class="theme-card-body">
            <p style="margin-bottom: 10px;"><strong>ä¸»è‰²è°ƒ</strong></p>
            <div>
              <span class="color-swatch" style="background: #2563eb;" title="Primary"></span>
              <span class="color-swatch" style="background: #64748b;" title="Secondary"></span>
              <span class="color-swatch" style="background: #f59e0b;" title="Accent"></span>
            </div>
            <p style="margin: 15px 0 10px;"><strong>æ–‡æœ¬é¢œè‰²</strong></p>
            <div>
              <span class="color-swatch" style="background: #1e293b;" title="Text Primary"></span>
              <span class="color-swatch" style="background: #64748b;" title="Text Secondary"></span>
            </div>
            <p style="margin: 15px 0 10px;"><strong>èƒŒæ™¯é¢œè‰²</strong></p>
            <div>
              <span class="color-swatch" style="background: #ffffff;" title="Background"></span>
              <span class="color-swatch" style="background: #f8fafc;" title="Background Alt"></span>
            </div>
          </div>
        </div>
        
        <div class="theme-card dark-theme">
          <div class="theme-card-header">æ·±è‰²ä¸»é¢˜</div>
          <div class="theme-card-body">
            <p style="margin-bottom: 10px;"><strong>ä¸»è‰²è°ƒ</strong></p>
            <div>
              <span class="color-swatch" style="background: #3b82f6;" title="Primary"></span>
              <span class="color-swatch" style="background: #94a3b8;" title="Secondary"></span>
              <span class="color-swatch" style="background: #fbbf24;" title="Accent"></span>
            </div>
            <p style="margin: 15px 0 10px;"><strong>æ–‡æœ¬é¢œè‰²</strong></p>
            <div>
              <span class="color-swatch" style="background: #f1f5f9;" title="Text Primary"></span>
              <span class="color-swatch" style="background: #cbd5e1;" title="Text Secondary"></span>
            </div>
            <p style="margin: 15px 0 10px;"><strong>èƒŒæ™¯é¢œè‰²</strong></p>
            <div>
              <span class="color-swatch" style="background: #0f172a;" title="Background"></span>
              <span class="color-swatch" style="background: #1e293b;" title="Background Alt"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="test-section">
      <h2>æœ¬åœ°å­˜å‚¨çŠ¶æ€</h2>
      <div id="storageStatus"></div>
    </div>
    
    <div class="test-section">
      <h2>ç³»ç»Ÿä¸»é¢˜æ£€æµ‹</h2>
      <div id="systemThemeTests"></div>
    </div>
    
    <div class="test-section">
      <h2>è¿‡æ¸¡åŠ¨ç”»æµ‹è¯•</h2>
      <div id="transitionTests"></div>
      <p style="margin-top: 10px; color: #64748b;">
        ä¸»é¢˜åˆ‡æ¢æ—¶ï¼Œæ‰€æœ‰é¢œè‰²åº”è¯¥å¹³æ»‘è¿‡æ¸¡ï¼ˆ300msï¼‰
      </p>
    </div>
  </div>

  <script>
    // Test theme functions
    function testThemeFunctions() {
      const tests = [
        {
          name: 'ä¸»é¢˜ç®¡ç†å™¨å­˜åœ¨',
          test: () => typeof window.themeManager !== 'undefined',
          description: 'window.themeManager å¯¹è±¡å·²å®šä¹‰'
        },
        {
          name: 'toggle æ–¹æ³•',
          test: () => typeof window.themeManager?.toggle === 'function',
          description: 'ä¸»é¢˜åˆ‡æ¢æ–¹æ³•å¯ç”¨'
        },
        {
          name: 'set æ–¹æ³•',
          test: () => typeof window.themeManager?.set === 'function',
          description: 'ä¸»é¢˜è®¾ç½®æ–¹æ³•å¯ç”¨'
        },
        {
          name: 'get æ–¹æ³•',
          test: () => typeof window.themeManager?.get === 'function',
          description: 'ä¸»é¢˜è·å–æ–¹æ³•å¯ç”¨'
        },
        {
          name: 'localStorage æ”¯æŒ',
          test: () => typeof localStorage !== 'undefined',
          description: 'æµè§ˆå™¨æ”¯æŒ localStorage'
        }
      ];
      
      const container = document.getElementById('themeFunctionTests');
      container.innerHTML = '';
      
      tests.forEach(test => {
        const result = document.createElement('div');
        const passed = test.test();
        result.className = `test-result ${passed ? 'pass' : 'fail'}`;
        result.innerHTML = `
          <strong>${passed ? 'âœ“' : 'âœ—'} ${test.name}</strong><br>
          ${test.description}
        `;
        container.appendChild(result);
      });
    }
    
    // Test theme toggle
    function testThemeToggle() {
      if (!window.themeManager) {
        alert('ä¸»é¢˜ç®¡ç†å™¨æœªåŠ è½½ã€‚è¯·åœ¨ä¸»é¡µé¢ä¸­æµ‹è¯•ã€‚');
        return;
      }
      
      const currentTheme = window.themeManager.get();
      window.themeManager.toggle();
      const newTheme = window.themeManager.get();
      
      const result = document.createElement('div');
      result.className = `test-result ${currentTheme !== newTheme ? 'pass' : 'fail'}`;
      result.innerHTML = `
        <strong>${currentTheme !== newTheme ? 'âœ“' : 'âœ—'} ä¸»é¢˜åˆ‡æ¢æµ‹è¯•</strong><br>
        åˆ‡æ¢å‰: ${currentTheme} â†’ åˆ‡æ¢å: ${newTheme}
      `;
      
      document.getElementById('themeFunctionTests').appendChild(result);
      
      // Update storage status
      updateStorageStatus();
    }
    
    // Test localStorage
    function testLocalStorage() {
      const key = 'theme-preference';
      const savedTheme = localStorage.getItem(key);
      
      const result = document.createElement('div');
      result.className = `test-result ${savedTheme ? 'pass' : 'info'}`;
      result.innerHTML = `
        <strong>${savedTheme ? 'âœ“' : 'â„¹'} æœ¬åœ°å­˜å‚¨æµ‹è¯•</strong><br>
        ${savedTheme ? `å·²ä¿å­˜ä¸»é¢˜åå¥½: ${savedTheme}` : 'æœªä¿å­˜ä¸»é¢˜åå¥½ï¼ˆå°†ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ï¼‰'}
      `;
      
      document.getElementById('themeFunctionTests').appendChild(result);
      updateStorageStatus();
    }
    
    // Clear theme preference
    function clearThemePreference() {
      localStorage.removeItem('theme-preference');
      alert('ä¸»é¢˜åå¥½å·²æ¸…é™¤ã€‚åˆ·æ–°é¡µé¢å°†ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ä¸»é¢˜ã€‚');
      updateStorageStatus();
    }
    
    // Update storage status
    function updateStorageStatus() {
      const container = document.getElementById('storageStatus');
      const savedTheme = localStorage.getItem('theme-preference');
      
      container.innerHTML = `
        <div class="storage-info">
          <strong>localStorage é”®:</strong> <code>theme-preference</code><br>
          <strong>å½“å‰å€¼:</strong> <code>${savedTheme || '(æœªè®¾ç½®)'}</code><br>
          <strong>è¯´æ˜:</strong> ${savedTheme ? 'ç”¨æˆ·å·²è®¾ç½®ä¸»é¢˜åå¥½' : 'å°†ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ä¸»é¢˜'}
        </div>
      `;
    }
    
    // Test system theme detection
    function testSystemTheme() {
      const container = document.getElementById('systemThemeTests');
      
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
      const prefersLight = window.matchMedia('(prefers-color-scheme: light)');
      
      const systemTheme = prefersDark.matches ? 'dark' : (prefersLight.matches ? 'light' : 'no-preference');
      
      container.innerHTML = `
        <div class="test-result pass">
          <strong>âœ“ ç³»ç»Ÿä¸»é¢˜æ£€æµ‹</strong><br>
          å½“å‰ç³»ç»Ÿä¸»é¢˜åå¥½: <code>${systemTheme}</code>
        </div>
        <div class="test-result info">
          <strong>â„¹ prefers-color-scheme æ”¯æŒ</strong><br>
          æµè§ˆå™¨æ”¯æŒç³»ç»Ÿä¸»é¢˜æ£€æµ‹: ${prefersDark ? 'æ˜¯' : 'å¦'}
        </div>
        <div class="storage-info">
          <strong>è¯´æ˜:</strong><br>
          â€¢ å¦‚æœç”¨æˆ·æœªè®¾ç½®ä¸»é¢˜åå¥½ï¼Œå°†è‡ªåŠ¨ä½¿ç”¨ç³»ç»Ÿä¸»é¢˜<br>
          â€¢ ç³»ç»Ÿä¸»é¢˜å˜åŒ–æ—¶ï¼Œå¦‚æœç”¨æˆ·æœªè®¾ç½®åå¥½ï¼Œä¸»é¢˜ä¼šè‡ªåŠ¨æ›´æ–°<br>
          â€¢ ç”¨æˆ·è®¾ç½®çš„ä¸»é¢˜åå¥½ä¼˜å…ˆçº§é«˜äºç³»ç»Ÿä¸»é¢˜
        </div>
      `;
    }
    
    // Test transitions
    function testTransitions() {
      const container = document.getElementById('transitionTests');
      
      const tests = [
        { property: 'background-color', duration: '300ms' },
        { property: 'color', duration: '300ms' },
        { property: 'border-color', duration: '300ms' },
        { property: 'box-shadow', duration: '300ms' }
      ];
      
      container.innerHTML = '';
      
      tests.forEach(test => {
        const result = document.createElement('div');
        result.className = 'test-result pass';
        result.innerHTML = `
          <strong>âœ“ ${test.property}</strong><br>
          è¿‡æ¸¡æ—¶é•¿: ${test.duration}
        `;
        container.appendChild(result);
      });
      
      const info = document.createElement('div');
      info.className = 'test-result info';
      info.innerHTML = `
        <strong>â„¹ æµ‹è¯•æ–¹æ³•</strong><br>
        åœ¨ä¸»é¡µé¢ä¸­ç‚¹å‡»ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼Œè§‚å¯Ÿé¢œè‰²æ˜¯å¦å¹³æ»‘è¿‡æ¸¡
      `;
      container.appendChild(info);
    }
    
    // Initialize tests
    testThemeFunctions();
    updateStorageStatus();
    testSystemTheme();
    testTransitions();
    
    // Listen for storage changes
    window.addEventListener('storage', (e) => {
      if (e.key === 'theme-preference') {
        updateStorageStatus();
      }
    });
  </script>
</body>
</html>
